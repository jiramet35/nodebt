{"ast":null,"code":"import _slicedToArray from\"I:/Programming/React/nodebt/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useRef,useState}from\"react\";import $ from'jquery';import Swal from\"sweetalert2\";import{Navigate,useNavigate}from\"react-router-dom\";import\"./auth.css\";import logo from'./img/pwalogo.png';import secureLocalStorage from\"react-secure-storage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Auth(){var refUser=useRef();var refPass=useRef();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),stateUsr=_useState2[0],setUser=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),stateLogin=_useState4[0],setStateLogin=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),loginStatus=_useState6[0],setloginStatus=_useState6[1];var navigate=useNavigate();var logon=function logon(){//const bodyData = JSON.stringify({\"pwaUser\" : refUser.current.value,\"pwaPass\" : refPass.current.value});\nvar bodyData={usr:refUser.current.value,pwd:refPass.current.value};axios.post('https://reg2intranet.pwa.co.th/api/authen',bodyData).then(function(res){var pwaStaff=res.data;if(pwaStaff.status==\"success\"){//console.log(pwaStaff)\n}else if(pwaStaff.status==\"notsuccess\"){sessionStorage.clear();}if(pwaStaff.status==\"success\"){sessionStorage.setItem(\"PWAusr\",pwaStaff.username);sessionStorage.setItem(\"PWAstaffname\",pwaStaff.firstname+\" \"+pwaStaff.lastname);sessionStorage.setItem(\"PWAusr\",pwaStaff.username);sessionStorage.setItem(\"APIStatus\",pwaStaff.status);sessionStorage.setItem(\"PWALoginStatus\",pwaStaff.status_desc);sessionStorage.setItem(\"PWALoginInfo\",JSON.stringify(pwaStaff));secureLocalStorage.setItem(\"PWAusr\",pwaStaff.username);secureLocalStorage.setItem(\"PWALoginInfo\",JSON.stringify(pwaStaff));Swal.fire({icon:'success',title:'Login Success',text:'เข้าสู่ระบบสำเร็จ'}).then(function(result){/* Read more about isConfirmed, isDenied below */if(result.isConfirmed){navigate(\"/nodebtlist\");}else if(result.isDenied){Swal.fire('ยกเลิก','','error');sessionStorage.clear();}});}else{Swal.fire({icon:'error',title:'Login Failed',text:'username หรือ รหัสผ่านไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง'});}});};var clrTextField=function clrTextField(){refUser.current.value=\"\";refPass.current.value=\"\";};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"offset-md-2 col-lg-5 col-md-7 offset-lg-4 offset-md-3 centerPanel\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"panel border bg-white\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-heading\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{src:logo,width:\"38%\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"pt-3 font-weight-bold\",children:\"\\u0E01\\u0E32\\u0E23\\u0E1B\\u0E23\\u0E30\\u0E1B\\u0E32\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E20\\u0E39\\u0E21\\u0E34\\u0E20\\u0E32\\u0E04\\u0E40\\u0E02\\u0E15 2\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"panel-body p-3\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"\",method:\"POST\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"far fa-user p-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",ref:refUser,id:\"textUser\",required:true})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group py-1 pb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fas fa-lock px-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",ref:refPass,id:\"textPwd\",placeholder:\"Enter your Password\",required:true})]})}),/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:/*#__PURE__*/_jsx(\"b\",{children:/*#__PURE__*/_jsx(\"i\",{children:\"** \\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\\u0E14\\u0E49\\u0E27\\u0E22 username \\u0E41\\u0E25\\u0E30 password \\u0E01\\u0E1B\\u0E20. **\"})})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-success\",id:\"login\",onClick:logon,children:\"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\"}),\"\\xA0\",/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-danger\",id:\"clrText\",onClick:clrTextField,children:\" \\xA0\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01 \\xA0 \"}),/*#__PURE__*/_jsx(\"hr\",{})]})})]})})})})})});}export default Auth;","map":{"version":3,"names":["axios","useRef","useState","$","Swal","Navigate","useNavigate","logo","secureLocalStorage","jsx","_jsx","jsxs","_jsxs","Auth","refUser","refPass","_useState","_useState2","_slicedToArray","stateUsr","setUser","_useState3","_useState4","stateLogin","setStateLogin","_useState5","_useState6","loginStatus","setloginStatus","navigate","logon","bodyData","usr","current","value","pwd","post","then","res","pwaStaff","data","status","sessionStorage","clear","setItem","username","firstname","lastname","status_desc","JSON","stringify","fire","icon","title","text","result","isConfirmed","isDenied","clrTextField","children","className","src","width","action","method","type","placeholder","ref","id","required","style","color","onClick"],"sources":["I:/Programming/React/nodebt/src/auth.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useRef, useState } from \"react\";\r\nimport $ from 'jquery';\r\nimport Swal from \"sweetalert2\";\r\nimport { Navigate,useNavigate } from \"react-router-dom\";\r\nimport \"./auth.css\"\r\nimport logo from './img/pwalogo.png';\r\nimport secureLocalStorage from \"react-secure-storage\";\r\n\r\nfunction Auth(){\r\n    const refUser = useRef();\r\n    const refPass = useRef();\r\n    const [stateUsr,setUser] = useState(null);\r\n    const [stateLogin,setStateLogin] = useState(null);\r\n    const [loginStatus , setloginStatus] = useState(null);\r\n    const navigate = useNavigate();\r\n\r\n    const logon = () =>{\r\n        //const bodyData = JSON.stringify({\"pwaUser\" : refUser.current.value,\"pwaPass\" : refPass.current.value});\r\n        const bodyData = {usr: refUser.current.value , pwd :  refPass.current.value}\r\n        axios.post('https://reg2intranet.pwa.co.th/api/authen',bodyData)\r\n        .then(res => {\r\n          const pwaStaff = res.data;\r\n          if(pwaStaff.status == \"success\"){\r\n            //console.log(pwaStaff)\r\n          }else if(pwaStaff.status == \"notsuccess\"){\r\n            sessionStorage.clear();\r\n          }\r\n          if(pwaStaff.status == \"success\"){\r\n            sessionStorage.setItem(\"PWAusr\", pwaStaff.username);\r\n            sessionStorage.setItem(\"PWAstaffname\", pwaStaff.firstname + \" \" +pwaStaff.lastname);\r\n            sessionStorage.setItem(\"PWAusr\", pwaStaff.username);\r\n            sessionStorage.setItem(\"APIStatus\", pwaStaff.status);\r\n            sessionStorage.setItem(\"PWALoginStatus\", pwaStaff.status_desc);\r\n            sessionStorage.setItem(\"PWALoginInfo\", JSON.stringify(pwaStaff));\r\n\r\n            secureLocalStorage.setItem(\"PWAusr\", pwaStaff.username);\r\n            secureLocalStorage.setItem(\"PWALoginInfo\", JSON.stringify(pwaStaff));\r\n            Swal.fire({\r\n                icon: 'success',\r\n                title: 'Login Success',\r\n                text: 'เข้าสู่ระบบสำเร็จ',\r\n              }).then((result) => {\r\n                /* Read more about isConfirmed, isDenied below */\r\n                if (result.isConfirmed) {\r\n                    navigate(\"/nodebtlist\");\r\n                } else if (result.isDenied) {\r\n                  Swal.fire('ยกเลิก', '', 'error');\r\n                  sessionStorage.clear();\r\n                }\r\n            });\r\n            \r\n        }else{\r\n            Swal.fire({\r\n                icon: 'error',\r\n                title: 'Login Failed',\r\n                text: 'username หรือ รหัสผ่านไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง',\r\n              })\r\n            }\r\n        })\r\n    }\r\n\r\n    const clrTextField = () =>{\r\n        refUser.current.value = \"\";\r\n        refPass.current.value = \"\";\r\n    }\r\n\r\n    return(\r\n        <div>\r\n            <div>\r\n                <div className=\"container\">\r\n                    <div className=\"row\">\r\n                    <div className=\"offset-md-2 col-lg-5 col-md-7 offset-lg-4 offset-md-3 centerPanel\">\r\n                        <div className=\"panel border bg-white\">\r\n                        <div className=\"panel-heading\">\r\n                            <br />\r\n                            <img src={logo} width=\"38%\" />\r\n                            <h3 className=\"pt-3 font-weight-bold\">การประปาส่วนภูมิภาคเขต 2</h3>\r\n                        </div>\r\n                        <div className=\"panel-body p-3\">\r\n\r\n                            <form action=\"\" method=\"POST\">\r\n\r\n\r\n                            <div className=\"form-group py-2\">\r\n                                <div className=\"input-field\">\r\n                                <span className=\"far fa-user p-2\" />\r\n                                <input type=\"text\" placeholder=\"Username\" ref={refUser} id=\"textUser\" required />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"form-group py-1 pb-2\">\r\n                                <div className=\"input-field\">\r\n                                <span className=\"fas fa-lock px-2\" />\r\n                                <input type=\"password\" ref={refPass} id=\"textPwd\" placeholder=\"Enter your Password\" required />\r\n                                </div>\r\n                            </div>\r\n                            <span style={{color: 'red'}}><b><i>** เข้าสู่ระบบด้วย username และ password กปภ. **</i></b></span>\r\n                                <hr />\r\n                                <div className=\"btn btn-success\" id=\"login\" onClick={logon}>เข้าสู่ระบบ</div>\r\n                                &nbsp;\r\n                                <div className=\"btn btn-danger\" id=\"clrText\" onClick={clrTextField}> &nbsp;ยกเลิก &nbsp; </div>\r\n                                {/* <div class=\"btn btn-primary btn-block mt-3\" id=\"loout\">Logout</div> */}\r\n                                <hr />\r\n                            </form></div>\r\n                        </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Auth;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}