{"ast":null,"code":"import _slicedToArray from\"I:/Programming/React/nodebt/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useRef,useState}from\"react\";import $ from'jquery';import Swal from\"sweetalert2\";import{Navigate,useNavigate}from\"react-router-dom\";import\"./auth.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Auth(){var refUser=useRef();var refPass=useRef();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),stateUsr=_useState2[0],setUser=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),stateLogin=_useState4[0],setStateLogin=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),loginStatus=_useState6[0],setloginStatus=_useState6[1];var navigate=useNavigate();var logon=function logon(){//const bodyData = JSON.stringify({\"pwaUser\" : refUser.current.value,\"pwaPass\" : refPass.current.value});\nvar bodyData={usr:refUser.current.value,\"pwd\":refPass.current.value};axios.post('https://reg2intranet.pwa.co.th/api/authen',bodyData).then(function(res){var pwaStaff=res.data;if(pwaStaff.status==\"success\"){//console.log(pwaStaff)\n}else if(pwaStaff.status==\"notsuccess\"){sessionStorage.clear();}if(pwaStaff.status==\"success\"){sessionStorage.setItem(\"PWAusr\",pwaStaff.username);sessionStorage.setItem(\"PWAstaffname\",pwaStaff.firstname+\" \"+pwaStaff.lastname);sessionStorage.setItem(\"PWAusr\",pwaStaff.username);sessionStorage.setItem(\"APIStatus\",pwaStaff.status);sessionStorage.setItem(\"PWALoginStatus\",pwaStaff.status_desc);sessionStorage.setItem(\"PWALoginInfo\",pwaStaff);Swal.fire({icon:'success',title:'Login Success',text:'เข้าสู่ระบบสำเร็จ'}).then(function(result){/* Read more about isConfirmed, isDenied below */if(result.isConfirmed){navigate(\"/nodebtlist\");}else if(result.isDenied){Swal.fire('ยกเลิก','','error');sessionStorage.clear();}});}else{Swal.fire({icon:'error',title:'Login Failed',text:'username หรือ รหัสผ่านไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง'});alert();}});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"offset-md-2 col-lg-5 col-md-7 offset-lg-4 offset-md-3 centerPanel\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"panel border bg-white\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-heading\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{src:\"%PUBLIC_URL%/assets/img/pwalogo.png\",width:\"38%\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"pt-3 font-weight-bold\",children:\"\\u0E01\\u0E32\\u0E23\\u0E1B\\u0E23\\u0E30\\u0E1B\\u0E32\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E20\\u0E39\\u0E21\\u0E34\\u0E20\\u0E32\\u0E04\\u0E40\\u0E02\\u0E15 2\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"panel-body p-3\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"login_script.php\",method:\"POST\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"far fa-user p-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",ref:refUser,id:\"textUser\",required:true})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group py-1 pb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fas fa-lock px-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",ref:refPass,id:\"textPwd\",placeholder:\"Enter your Password\",required:true})]})}),/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:/*#__PURE__*/_jsx(\"b\",{children:/*#__PURE__*/_jsx(\"i\",{children:\"** \\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\\u0E14\\u0E49\\u0E27\\u0E22 username \\u0E41\\u0E25\\u0E30 password \\u0E01\\u0E1B\\u0E20. **\"})})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-primary btn-block mt-3\",id:\"login\",onClick:logon,children:\"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\"}),/*#__PURE__*/_jsx(\"hr\",{})]})})]})})})})})});}export default Auth;","map":{"version":3,"names":["axios","useRef","useState","$","Swal","Navigate","useNavigate","jsx","_jsx","jsxs","_jsxs","Auth","refUser","refPass","_useState","_useState2","_slicedToArray","stateUsr","setUser","_useState3","_useState4","stateLogin","setStateLogin","_useState5","_useState6","loginStatus","setloginStatus","navigate","logon","bodyData","usr","current","value","post","then","res","pwaStaff","data","status","sessionStorage","clear","setItem","username","firstname","lastname","status_desc","fire","icon","title","text","result","isConfirmed","isDenied","alert","children","className","src","width","action","method","type","placeholder","ref","id","required","style","color","onClick"],"sources":["I:/Programming/React/nodebt/src/auth.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useRef, useState } from \"react\";\r\nimport $ from 'jquery';\r\nimport Swal from \"sweetalert2\";\r\nimport { Navigate,useNavigate } from \"react-router-dom\";\r\nimport \"./auth.css\"\r\n\r\nfunction Auth(){\r\n    const refUser = useRef();\r\n    const refPass = useRef();\r\n    const [stateUsr,setUser] = useState(null);\r\n    const [stateLogin,setStateLogin] = useState(null);\r\n    const [loginStatus , setloginStatus] = useState(null);\r\n    const navigate = useNavigate();\r\n\r\n    const logon = () =>{\r\n        //const bodyData = JSON.stringify({\"pwaUser\" : refUser.current.value,\"pwaPass\" : refPass.current.value});\r\n        const bodyData = {usr: refUser.current.value , \"pwd\" :  refPass.current.value}\r\n        axios.post('https://reg2intranet.pwa.co.th/api/authen',bodyData)\r\n        .then(res => {\r\n          const pwaStaff = res.data;\r\n          if(pwaStaff.status == \"success\"){\r\n            //console.log(pwaStaff)\r\n          }else if(pwaStaff.status == \"notsuccess\"){\r\n            sessionStorage.clear();\r\n          }\r\n          if(pwaStaff.status == \"success\"){\r\n            sessionStorage.setItem(\"PWAusr\", pwaStaff.username);\r\n            sessionStorage.setItem(\"PWAstaffname\", pwaStaff.firstname + \" \" +pwaStaff.lastname);\r\n            sessionStorage.setItem(\"PWAusr\", pwaStaff.username);\r\n            sessionStorage.setItem(\"APIStatus\", pwaStaff.status);\r\n            sessionStorage.setItem(\"PWALoginStatus\", pwaStaff.status_desc);\r\n            sessionStorage.setItem(\"PWALoginInfo\", pwaStaff);\r\n            Swal.fire({\r\n                icon: 'success',\r\n                title: 'Login Success',\r\n                text: 'เข้าสู่ระบบสำเร็จ',\r\n              }).then((result) => {\r\n                /* Read more about isConfirmed, isDenied below */\r\n                if (result.isConfirmed) {\r\n                    navigate(\"/nodebtlist\");\r\n                } else if (result.isDenied) {\r\n                  Swal.fire('ยกเลิก', '', 'error');\r\n                  sessionStorage.clear();\r\n                }\r\n            });\r\n            \r\n        }else{\r\n            Swal.fire({\r\n                icon: 'error',\r\n                title: 'Login Failed',\r\n                text: 'username หรือ รหัสผ่านไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง',\r\n              })\r\n              alert()\r\n            }\r\n        })\r\n\r\n\r\n    }\r\n    return(\r\n        <div>\r\n            <div>\r\n                <div className=\"container\">\r\n                    <div className=\"row\">\r\n                    <div className=\"offset-md-2 col-lg-5 col-md-7 offset-lg-4 offset-md-3 centerPanel\">\r\n                        <div className=\"panel border bg-white\">\r\n                        <div className=\"panel-heading\">\r\n                            <br />\r\n                            <img src=\"%PUBLIC_URL%/assets/img/pwalogo.png\" width=\"38%\" />\r\n                            <h3 className=\"pt-3 font-weight-bold\">การประปาส่วนภูมิภาคเขต 2</h3>\r\n                        </div>\r\n                        <div className=\"panel-body p-3\">\r\n                            <form action=\"login_script.php\" method=\"POST\">\r\n                            <div className=\"form-group py-2\">\r\n                                <div className=\"input-field\">\r\n                                <span className=\"far fa-user p-2\" />\r\n                                <input type=\"text\" placeholder=\"Username\" ref={refUser} id=\"textUser\" required />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"form-group py-1 pb-2\">\r\n                                <div className=\"input-field\">\r\n                                <span className=\"fas fa-lock px-2\" />\r\n                                <input type=\"password\" ref={refPass} id=\"textPwd\" placeholder=\"Enter your Password\" required />\r\n                                </div>\r\n                            </div>\r\n                            <span style={{color: 'red'}}><b><i>** เข้าสู่ระบบด้วย username และ password กปภ. **</i></b></span>\r\n                                <hr />\r\n                                <div className=\"btn btn-primary btn-block mt-3\" id=\"login\" onClick={logon}>เข้าสู่ระบบ</div>\r\n                                {/* <div class=\"btn btn-primary btn-block mt-3\" id=\"loout\">Logout</div> */}\r\n                                <hr />\r\n                            </form></div>\r\n                        </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Auth;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}